`202005_extraplot_herbivory` <- read.delim("~/Fac/Cesure2/Plant species coexistence/protocols/202005_extraplot_herbivory.txt")
View(`202005_extraplot_herbivory`)
data<- read.delim("~/Fac/Cesure2/Plant species coexistence/protocols/202005_extraplot_herbivory.txt")
head(data)
load("~/Fac/Cesure2/Plant species coexistence/functions_and_coex/workspaces/biomasse.RData")
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_shift, col=species))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
library(ggplot2)
library(dplyr)
library(tidyr)
library(lme4)
library(emmeans)
library(lmerTest)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_shift, col=species))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(Omega, biomass, col=species))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
str(main_data_control)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
str(summary(mod_biom_shift))
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
hist(summary(mod_biom_shift)$residuals)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
coef
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ log(Omega) + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(log(Omega), biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(Omega, log(biomass_per_sp)  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = log(biomass_per_sp) ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, log(biomass_per_sp)  , col=specie_solo))+
geom_abline(intercept = coef[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
coef[1,1]
coef_biom_shift[2,1]
str(summary(mod_biom_shift))
summary(mod_biom_shift)
str(summary(mod_biom_shift))
coef
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, log(biomass_per_sp)  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
coef_biom_shift
coef_biom_shift[1,1]
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = log(biomass_per_sp) ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
str(summary(mod_biom_shift))
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
hist(summary(mod_biom_shift)$residuals)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega (Omega|specie_solo),data = main_data_control)
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (Omega|specie_solo),data = main_data_control)
mod_biom_shift
summary(mod_biom_shift)
coef_biom_shift
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (Omega|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(feasibility, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
geom_boxplot(aes(feasibility, biomass_per_sp)+
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
biomass_per_sp$feasibility= =as.factor(biomass_per_sp$feasibility)
### Increasing niche difference will add
biomass_per_sp$feasibility = as.factor(biomass_per_sp$feasibility)
### Increasing niche difference will add
biomass_per_sp$feasibility = as.factor(biomass_per_sp$feasibility)
biomass_per_sp$feasibility
biomass_per_sp
##### biomass models #####
main_data$feasibility = as.factor(biomass_per_sp$feasibility)
main_data_control = subset(main_data, main_data$nitrogen == 0 &
main_data$type == "triplet")
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
str(main_data_control)
##### biomass models #####
main_data$feasibility = as.factor(main_data$feasibility)
main_data_control = subset(main_data, main_data$nitrogen == 0 &
main_data$type == "triplet")
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(indirect_effects, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
mod_biom_shift <- lmer(formula = biomass ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
### Increasing niche difference will add
str(main_data_control)
summary(mod_biom_shift)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass ))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(indirect_effects, biomass))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
save.image("~/Fac/Cesure2/Plant species coexistence/functions_and_coex/workspaces/biomasse.RData")
enz_act <- read.delim2(file.path(data_dir,"enz_act.txt"), header = TRUE)
for (i in 1){
library(ggplot2)
library(dplyr)
library(tidyr)
library(readxl)
library(writexl)
}
#### load and shape data ####
localDir="~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/"
setwd(localDir)
data_dir = "oster_data_2022"
enz_act <- read.delim2(file.path(data_dir,"enz_act.txt"), header = TRUE)
soil_weight <- read.delim2(file.path(data_dir,"soil_weight.txt"), header = TRUE)
soil_timing <- read.delim2(file.path(data_dir,"soil_timing.txt"), header = TRUE)
###### Enzymatic data #######
head(soil_weight)
head(enz_act)
str(enz_act)
enz_act <- read.delim2(file.path(data_dir,"enz_act.txt"), header = TRUE, dec = ".")
str(enz_act)
enz_act[,1:7]
enz_act
enz_act[enz_act=="na"]=NA
enz_act[!is.na(enz_act$plot),]
enz_act
enz_act$plot
tail(enz_act)
enz_act=enz_act[!is.na(enz_act$plot),]
str(enz_act)
names(enz_act)[6]
names(enz_act)[6]="p_nytro_C"
enz_act$nitrogen = as.character(enz_act$nitrogen)
enz_act$nitrogen[enz_act$nitrogen == "1"] = "nitrogen"
enz_act$nitrogen[enz_act$nitrogen == "0"] = "control"
names(enz_act)[names(enz_act) == "plot" | names(enz_act) == "nitrogen"] = c("treatment", "plot_ID")
order(enz_act$enz, enz_act$plot)
enz_act$enz
enz_act[order(enz_act$enz, enz_act$plot),]
enz_act = enz_act[order(enz_act$enz, enz_act$plot),]
names(soil_weight)[names(soil_weight) == "plot" | names(soil_weight) == "nitrogen"]
##soil_weight
soil_weight$nitrogen = as.character(soil_weight$nitrogen)
soil_weight
##soil_weight
soil_weight$nitrogen = as.character(soil_weight$nitrogen)
soil_weight
##soil_weight
soil_weight$treatement = as.character(soil_weight$treatement)
soil_weight$treatement[soil_weight$treatement == "1"] = "nitrogen"
soil_weight$treatement[soil_weight$treatement == "0"] = "control"
soil_weight
soil_weight=soil_weight[!is.na(soil_weight$plot),]
str(soil_weight)
soil_weight <- read.delim2(file.path(data_dir,"soil_weight.txt"), header = TRUE, dec = ".")
soil_timing <- read.delim2(file.path(data_dir,"soil_timing.txt"), header = TRUE, dec = ".")
par_height <- read.delim2(file.path(data_dir,"PAR_and_height6.txt"),header = TRUE, dec = ".")
herbi <- read.delim2(file.path(data_dir,"herbi_patho_ostermundigen_2022.txt"), header = TRUE, dec = ".")
cover <-read.delim2(file.path(data_dir,"cover_2022.txt"), header =TRUE, dec = ".")
bioma <- read.delim2(file.path(data_dir,"biomasse_OM_2022.txt"), header =TRUE, dec = ".")
##soil_weight
soil_weight$treatement = as.character(soil_weight$treatement)
soil_weight$treatement[soil_weight$treatement == "1"] = "nitrogen"
soil_weight$treatement[soil_weight$treatement == "0"] = "control"
str(soil_weight)
soil_weight
soil_weight=soil_weight[!is.na(soil_weight$plot),]
soil_weight
## soil_timing
head(soil_timing)
names(soil_weight)
names(soil_timing)
names(soil_timing)[2]= "treatment"
soil_timing$treatement[soil_timing$treatement == "N"] = "nitrogen"
soil_timing$treatement
soil_timing$treatment[soil_timing$treatment == "N"] = "nitrogen"
soil_timing$treatment[soil_timing$treatment == "C"] = "control"
soil_timing$enz = rep("phospha",120)
names(soil_weight)
names(soil_weight)[2]="treatment"
names(enz_act)[2]
names(enz_act
names(enz_act)
names(enz_act)
# merge data
enz_act = full_join(enz_act,soil_weight, by = c("plot", "nitrogen"))
# merge data
enz_act = full_join(enz_act,soil_weight, by = c("plot_ID", "treatment"))
enz_act = full_join(enz_act,soil_timing, by = c("plot_ID", "treatment","enz"))
head(enz_act)
head(enz_act[, c(1:7, 10:13)])
head(enz_act[, c(1:7, 10:13)])
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID == 22),]$comments
enz_act$comments
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID == 22),]$comments
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 23),]$comments
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 27),]$comments
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID == 22),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 23),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 27),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 34),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 31),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 11),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "control" & enz_act$plot_ID  == 6),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "control" & enz_act$plot_ID == 58),]$comments = c("wet","wet")
enz_act$type = ifelse(as.numeric(as.character(enz_act$plot)) <= 48 ,
"triplet", "mono")
enz_act
enz_act$type = ifelse(as.numeric(as.character(enz_act$plot_ID)) <= 48 ,
"triplet", "mono")
head(enz_act)
ggplot(enz_act)+
geom_boxplot(aes(treatment,nytro_release))+
facet_wrap(~enz)
ggplot(enz_act)+
geom_boxplot(aes(treatment,Abs))+
facet_wrap(~enz)
ggplot(enz_act[enz_act$sample!="cali",])+
geom_boxplot(aes(treatment,Abs))+
facet_wrap(~enz)
enz_act[enz_act$sample!="cali",]
enz_act$sample!="cali"
enz_act$sample
enz_act
enz_act <- read.delim2(file.path(data_dir,"enz_act.txt"), header = TRUE, dec = ".")
enz_act[enz_act=="na"]=NA
enz_act=enz_act[!is.na(enz_act$plot),]
enz_act$Abs = as.numeric(enz_act$Abs)
names(enz_act)[6]="p_nytro_C"
enz_act$nitrogen = as.character(enz_act$nitrogen)
enz_act$nitrogen[enz_act$nitrogen == "1"] = "nitrogen"
enz_act$nitrogen[enz_act$nitrogen == "0"] = "control"
names(enz_act)[names(enz_act) == "plot" | names(enz_act) == "nitrogen"] = c("treatment", "plot_ID")
enz_act = enz_act[order(enz_act$enz, enz_act$plot),]
# merge data
enz_act = full_join(enz_act,soil_weight, by = c("plot_ID", "treatment"))
enz_act = full_join(enz_act,soil_timing, by = c("plot_ID", "treatment","enz"))
head(enz_act)
enz_act$comments
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID == 22),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 23),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 27),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 34),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 31),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "nitrogen" & enz_act$plot_ID  == 11),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "control" & enz_act$plot_ID  == 6),]$comments = c("wet","wet")
enz_act[c(enz_act$treatment == "control" & enz_act$plot_ID == 58),]$comments = c("wet","wet")
enz_act$type = ifelse(as.numeric(as.character(enz_act$plot_ID)) <= 48 ,
"triplet", "mono")
enz_act$comments
ggplot(enz_act[enz_act$sample!="cali",])+
geom_boxplot(aes(treatment,Abs))+
facet_wrap(~enz)
ggplot(enz_act[enz_act$sample!="cali",])+
geom_boxplot(aes(treatment,Abs))+
geom_point(aes(treatment,Abs))
ggplot(enz_act[enz_act$sample!="cali",])+
geom_boxplot(aes(treatment,Abs))+
geom_point(aes(treatment,Abs))+
facet_wrap(~enz)
write.table(enz_act, file.path("data","enzimatic_activity.txt"), dec = ".", col.names = TRUE)
enz_act <- read.delim2("enzimatic_activity.txt",header= TRUE, sep=".")
enz_act <- read.delim2("enzimatic_activity.txt",header= TRUE, sep=".")
#### load and shape data ####
setwd("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/data")
#### load and shape data ####
setwd("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/data")
enz_act <- read.delim2("enzimatic_activity.txt",header= TRUE, sep=".")
enz_act
read.delim2("enzimatic_activity.txt",header= TRUE, sep=".")
#### load and shape data ####
setwd("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/data")
read.delim2("enzimatic_activity.txt", header= TRUE, sep=".")
enz_act <- read.delim2("enzimatic_activity.txt", header= TRUE, dec = ".")
enz_act
tail(enz_act)
enz_act <- read.delim2("enzimatic_activity.txt", header= TRUE, dec = ".",sep=" ")
tail(enz_act)
str(enz_act)
nrow(enz_act)
enz_act$dry_weight
enz_act$dry_weight/rep(5,nrow(enz_act))
#calculate the dry weight ratio(dry mass/fresh mass), fresh mass was weighted
#precisely around 5g +-0.005g
enz_act$dry_weight_ratio = enz_act$dry_weight/rep(5,nrow(enz_act))
### only calibration data
lm_cali = data.frame()
data_cali = subset(enz_act, sample == "cali")
str(data_cali)
for (n_cali in 1:6){
temp = subset(data_cali, cali_group == n_cali)
coefs = as.data.frame(lm(Abs~p_nytro_C, data = temp)$coefficients)
lm_cali = rbind(lm_cali,data.frame(intercept= coefs[1,], slope = coefs[2,],
cali_group = n_cali))
}
str(lm_cali)
### calculation of the concentrations given linear models of calibrations
data_enz = subset(enz_act, sample != "cali")
data_enz$p_nytro_C
data_enz
for (n_abs in 1:nrow(data_enz)){
n_cali = enz_act$cali_group[n_abs]
data_enz$p_nytro_C[n_abs] = ((data_enz$Abs[n_abs] - lm_cali[n_cali,1]) /
(lm_cali[n_cali,2] * data_enz$dry_weight_ratio[n_abs]))
}
tail(data_enz)
ggplot() +
geom_point(data = data_enz,
aes(p_nytro_C, Abs,col=enz,shape=sample),
cex = 1.5,color = "black")+
geom_point(data = data_enz,aes(p_nytro_C, Abs,col=enz,shape=sample),cex = 1)+
facet_wrap(~cali_group)+
geom_smooth(data =subset(enz_act, sample == "cali"),
aes(p_nytro_C,Abs ),method = lm,se = F,linetype=2, size=1)+
scale_y_continuous(limits=c(-0.1,1.1))+
scale_x_continuous(limits=c(-0.1,350))+
xlab("enz (in mmol.g-1.h-1)")+
theme(axis.text.x = element_text( size=25),
axis.text.y = element_text( size=25),
axis.title=element_text(size=30))
ggplot()  +
geom_boxplot(data = data_enz,aes(sample, p_nytro_C))+
facet_wrap(~enz)
ggplot()+
facet_wrap(~enz)+
geom_boxplot(data = data_enz,aes(date_time, p_nytro_C))
head(data_enz)
tail(data_enz)
data.frame(nytro_release = (subset(data_enz,sample == "a")$p_nytro_C -
subset(data_enz,sample == "b")$p_nytro_C) * 1/139)
subset(data_enz,sample == "a")$p_nytro_C
subset(data_enz,sample == "b")$p_nytro_C
nytro_release
### sample A - sample B
nytro_release = (subset(data_enz,sample == "a")$p_nytro_C -
subset(data_enz,sample == "b")$p_nytro_C) * 1/139
data_enz$nytro_release = nytro_release
data_enz
enz_act
head(data_enz)
head(enz_act)
str(data_enz)
str(enz_act)
subset(enz_act, enz_act$sample == "cali")
rbind(data_enz, subset(enz_act, enz_act$sample == "cali"))
enz_act$nytro_release = NA
rbind(data_enz, subset(enz_act, enz_act$sample == "cali"))
data_enz = rbind(data_enz, subset(enz_act, enz_act$sample == "cali"))
str(enz_act)
str(data_enz)
write.table(data_enz, "enzimatic_activity.txt", dec = ".", col.names = TRUE)
ggplot() +
geom_point(data = data_enz,
aes(p_nytro_C, Abs,col=enz,shape=sample),
cex = 1.5,color = "black")+
geom_point(data = data_enz,aes(p_nytro_C, Abs,col=enz,shape=sample),cex = 1)+
facet_wrap(~cali_group)+
geom_smooth(data =subset(enz_act, sample == "cali"),
aes(p_nytro_C,Abs ),method = lm,se = F,linetype=2, size=1)+
scale_y_continuous(limits=c(-0.1,1.1))+
scale_x_continuous(limits=c(-0.1,350))+
xlab("enz (in mmol.g-1.h-1)")+
theme(axis.text.x = element_text( size=25),
axis.text.y = element_text( size=25),
axis.title=element_text(size=30))
ggplot()  +
geom_boxplot(data = data_enz,aes(sample, p_nytro_C))+
facet_wrap(~enz)
ggplot()+
facet_wrap(~enz)+
geom_boxplot(data = data_enz,aes(date_time, p_nytro_C))
data_enz
