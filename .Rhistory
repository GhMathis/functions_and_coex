### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (Omega|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(Omega, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_point(aes(feasibility, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
geom_boxplot(aes(feasibility, biomass_per_sp)+
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
biomass_per_sp$feasibility= =as.factor(biomass_per_sp$feasibility)
### Increasing niche difference will add
biomass_per_sp$feasibility = as.factor(biomass_per_sp$feasibility)
### Increasing niche difference will add
biomass_per_sp$feasibility = as.factor(biomass_per_sp$feasibility)
biomass_per_sp$feasibility
biomass_per_sp
##### biomass models #####
main_data$feasibility = as.factor(biomass_per_sp$feasibility)
main_data_control = subset(main_data, main_data$nitrogen == 0 &
main_data$type == "triplet")
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
summary(mod_biom_shift)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
### Increasing niche difference will add
str(main_data_control)
##### biomass models #####
main_data$feasibility = as.factor(main_data$feasibility)
main_data_control = subset(main_data, main_data$nitrogen == 0 &
main_data$type == "triplet")
mod_biom_shift <- lmer(formula = biomass_per_sp ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
coef_biom_shift = summary(mod_biom_shift)$coefficients
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass_per_sp))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(indirect_effects, biomass_per_sp  , col=specie_solo))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
mod_biom_shift <- lmer(formula = biomass ~ Omega + feasibility + indirect_effects + coex_rate + (1|specie_solo),data = main_data_control)
### Increasing niche difference will add
str(main_data_control)
summary(mod_biom_shift)
ggplot(main_data_control)+
geom_point(aes(Omega, biomass ))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_point(aes(indirect_effects, biomass))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
ggplot(main_data_control)+
geom_boxplot(aes(feasibility, biomass))+
geom_abline(intercept = coef_biom_shift[1,1], slope = coef_biom_shift[2,1],
linetype =2 , color = "blue")
save.image("~/Fac/Cesure2/Plant species coexistence/functions_and_coex/workspaces/biomasse.RData")
localDir="~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/"
setwd(localDir)
data_dir = "organized_data"
load(file.path(data_dir,"par_and_height.RData"))
str(par_height)
### Time past since the first measurement (in day)
t0 = as.numeric(as.POSIXct(par_height$date))[1]
par_height$time = (as.numeric(as.POSIXct(par_height$date)) - t0)/(60*60*24)
par_height$plot = as.numeric(as.character(par_height$plot))
subset(par_height , par_height$plot == 1 )
par_height_long = par_height%>%
pivot_longer(cols= c("heigth_A", "heigth_B", "heigth_C", "heigth_D"),
names_to = "heights_spot",values_to = "height")
library(ggplot2)
library(dplyr)
library(tidyr)
library(lme4)
library(tidyverse)
par_height_long = par_height%>%
pivot_longer(cols= c("heigth_A", "heigth_B", "heigth_C", "heigth_D"),
names_to = "heights_spot",values_to = "height")
str(par_height_long)
ggplot(subset(par_height_long, par_height_long$nitrogen == "0" ))+
geom_point(aes(time, height))+
geom_point(aes(time, mean_height), col ="red")+
geom_smooth(aes(time, height),formula = y ~ poly(x, 2), method = "lm",
se=F, linetype = 2, size = 0.5)+
facet_wrap(~plot)
ggplot(subset(par_height_long, par_height_long$nitrogen == "1" ))+
geom_point(aes(time, height))+
geom_point(aes(time, mean_height), col ="red")+
geom_smooth(aes(time, height),formula = y ~ poly(x, 2), method = "lm",
se=F, linetype = 2, size = 0.5)+
facet_wrap(~plot)
formula =  mean_height ~ time + time2
canopy_list_models = list()
coef_df = matrix(ncol = 5, nrow = max(par_height$plot)*2)
par_height$time2 = par_height$time**2
for (n_plot in 1:max(par_height$plot)){
tabl_control = par_height[par_height$plot == n_plot & par_height$nitrogen == 0,]
tabl_nitro = par_height[par_height$plot == n_plot & par_height$nitrogen == 1,]
model_control = lm(formula = formula , data = tabl_control)
model_nitro = lm(formula = formula , data = tabl_nitro)
canopy_list_models <- append(canopy_list_models,
lapply(n_plot, function(x) list( model_control, model_nitro) ))
coef_df[2*n_plot-1,] = c(model_control$coefficients,0, n_plot )
coef_df[2*n_plot,] = c(model_nitro$coefficients,1,n_plot )
}
names(coef_df) = c("intercept", "coef1", "coef2", "nitrogen", "plot")
temp=coef_df
while(nrow(coef_df) < nrow(par_height)){
coef_df = rbind(coef_df, temp)
}
nrow(coef_df)
head(coef_df)
predictor = matrix(c(rep(1,nrow(coef_df)),
par_height$time,
par_height$time2),
ncol =3, dimnames = list(c(),c("intercept", "x", "x2")
))
dim(t(predictor))
dim(as.matrix(coef_df[,1:3]))
pred=c()
i=1
for ( i in 1:nrow(predictor)){
pred = append(pred, predictor[i,] %*% as.matrix(coef_df[i,1:3]))
}
par_height$pred = pred
par_height_long = par_height%>%
pivot_longer(cols= c("heigth_A", "heigth_B", "heigth_C", "heigth_D"),
names_to = "heights_spot",values_to = "height")
ggplot(subset(par_height_long, par_height_long$nitrogen == "1" ))+
geom_point(aes(time, height))+
geom_point(aes(time, mean_height), col ="red")+
geom_line(aes(time, pred), col ="red")+
geom_smooth(aes(time, height),formula = y ~ poly(x, 2), method = "lm",
se=F, linetype = 2, size = 0.5)+
facet_wrap(~plot)
par_height$time
as.matrix(coef_df[i,1:3])
predictor[i,]
derivative.poly2 <- function(coef1,coef2,x) 2 * (coef2) * x + coef1
derivative.poly2(1,1,1)
derivative.poly2(1,1,2)
derivative.poly2 <- function(coef1,coef2,x) 2 * (coef2) * x + coef1 /
abs(2 * (coef2) * x + coef1 )
derivative.poly2(1,1,2)
derivative.poly2(1,1,6)
derivative.poly2(1,1,0.5)
derivative.poly2(1,1,-1)
derivative.poly2(1,1,-1)
derivative.poly2 <- function(coef1,coef2,x)  2 * coef2 * x +coef1
derivative.poly2(1,1,-1)
solver.poly2 <-   function(interept, coef1, coef2, x)  coef2 * x**2 +
coef1 * x +
interept
solver.poly2(1,2,1,-1)
solver.poly2(1,2,1,-1)
solver.poly2(1,1,1,-1)
gradient.poly2 <- function(coef1, coef2, x)  2 * coef2 * x + coef1
save.image("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/workspaces/wks_growth_coef_comp.RData")
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(FactoMineR)
library(vegan)
library(factoextra)
localDir="~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/"
setwd(localDir)
getwd()
data_dir = "organized_data"
code_dir ="code"
##### load the data
load(file.path(data_dir,"bioma.RData"))
load(file.path(data_dir,"interactions_triplet.RData"))
load(file.path(data_dir,"cover.RData"))
load(file.path(data_dir,"enzimatic_activity.RData"))
load(file.path(data_dir,"herbivoty_pathogen.RData"))
##### load the functions
source(file.path(code_dir, "traits_shift_functions.R"))
########## shape the data ##########
cover_long = cover %>%
pivot_longer(cols = Be:legumes, names_to = "species_cover", values_to = "perc_cover")
str(cover_long)
str(cover)
hist(cover_long$perc_cover)
ggplot(cover_long)+
geom_point(aes(species_cover,perc_cover))
bioma = bioma[, c("nitrogen", "plot", "biomass", "species_1",
"species_2","species_3", "type")]
list_data_bioma = shape.df(bioma,cover,"biomass")
trait_mono_bioma = list_data_bioma[[1]]
trait_triplet_bioma = list_data_bioma[[2]]
## Beta-gluscosidase
beta_glu_df = subset(enz_act, enz_act$enz =="beta_glu")
nrow(beta_glu_df)
nrow(cover)
list_data_betaG = shape.df(beta_glu_df,cover,"nytro_release")
trait_mono_betaG = list_data_betaG[[1]]
trait_triplet_betaG = list_data_betaG[[2]]
nrow(trait_triplet_betaG)
nrow(trait_mono_betaG)
head(trait_triplet_betaG)
head(trait_mono_betaG)
## Phosphatase
phospha_df = subset(enz_act, enz_act$enz =="phospha")
nrow(phospha_df)
nrow(cover)
list_data_phospha = shape.df(phospha_df,cover,"nytro_release")
trait_mono_phospha = list_data_phospha[[1]]
trait_triplet_phospha = list_data_phospha[[2]]
nrow(trait_triplet_phospha)
nrow(trait_mono_phospha)
head(trait_triplet_phospha)
head(trait_mono_phospha)
trait_metrics_biomass = commu.traits.metrics(trait_mono = trait_mono_bioma,
trait_triplet = trait_triplet_bioma,
cover = cover,
trait_name_to = "biomass" )
traits_shift_data=c()
str(interactions)
trait_metrics_biomass_control = subset(trait_metrics_biomass,
trait_metrics_biomass$nitrogen == 0)
str(trait_metrics_biomass_control)
traits_shift_data = full_join(trait_metrics_biomass_control,interactions,
by = c("species","nitrogen"))
str(traits_shift_data)
trait_metrics_betaG = commu.traits.metrics(trait_mono = trait_mono_betaG,
trait_triplet = trait_triplet_betaG,
cover = cover,
trait_name_to = "beta_glu" )
head(trait_metrics_betaG)
trait_metrics_betaG_control = subset(trait_metrics_betaG,
trait_metrics_betaG$nitrogen == 0)
str(trait_metrics_biomass_control)
traits_shift_betaG = full_join(trait_metrics_betaG_control,interactions,
by = c("species","nitrogen"))
traits_shift_data = rbind(traits_shift_data, traits_shift_betaG)
nrow(traits_shift_data)
trait_metrics_phospha = commu.traits.metrics(trait_mono = trait_mono_phospha,
trait_triplet = trait_triplet_phospha,
cover = cover,
trait_name_to = "phospha" )
head(trait_metrics_phospha)
trait_metrics_phospha_control = subset(trait_metrics_phospha,
trait_metrics_phospha$nitrogen == 0)
str(trait_metrics_phospha_control)
traits_shift_phospha = full_join(trait_metrics_phospha_control,interactions,
by = c("species","nitrogen"))
traits_shift_data = rbind(traits_shift_data, traits_shift_phospha)
nrow(traits_shift_data)
head(traits_shift_data)
save.image("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/workspaces/wks_traits_shift.RData")
save(traits_shift_data,file = "organized_data/traits_shift_data.RData")
localDir="~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/"
setwd(localDir)
getwd()
data_dir = "organized_data"
code_dir ="code"
##### load the data
load(file.path(data_dir,"traits_shift_data.RData"))
##### models CWM #####
hist(biomass_data$CWM,breaks =48 )
hist(biomass_data$delta_ab_shift,breaks =48 )
head(traits_shift_data)
traits_shift_data[traits_shift_data$trait == "biomass",]
##### models CWM #####
biomass_data = traits_shift_data[traits_shift_data$trait == "biomass",]
hist(biomass_data$CWM,breaks =48 )
hist(biomass_data$delta_ab_shift,breaks =48 )
hist(biomass_data$delta_intra_shift,breaks =48 )
mod_CWM <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction) +
(1 | plot), data = biomass_data)
mod_CWM <- lmer(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction) +
(1 | plot), data = biomass_data)
mod_CWM <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = biomass_data)
summary(mod_CWM)
coef_CWM = summary(mod_CWM)$coefficients
hist(summary(mod_CWM)$residuals, breaks = 48)
hist(biomass_data$CWM)
ggplot(biomass_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[2,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_boxplot(aes(feasibility, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[3,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_point(aes(feasibility, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[3,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_boxplot(aes(as.factor(feasibility), CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[3,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_point(aes(indirect_effects, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[4,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_point(aes(year_extinction , CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[5,1],
linetype =2 , color = "blue")+
scale_x_log10()
traits_shift_data$trait
##### models CWM #####
beta_glu_data = traits_shift_data[traits_shift_data$trait == "beta_glu",]
hist(beta_glu_data$CWM,breaks =48 )
hist(beta_glu_data$delta_ab_shift,breaks =48 )
hist(beta_glu_data$delta_intra_shift,breaks =48 )
mod_CWM <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = beta_glu_data)
summary(mod_CWM)
coef_CWM = summary(mod_CWM)$coefficients
hist(summary(mod_CWM)$residuals, breaks = 48)
hist(beta_glu_data$CWM)
ggplot(beta_glu_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[2,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_boxplot(aes(as.factor(feasibility), CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[3,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_point(aes(indirect_effects, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[4,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_point(aes(year_extinction , CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[5,1],
linetype =2 , color = "blue")+
scale_x_log10()
head(traits_shift_data)
traits_shift_data$trait
##### models CWM #####
phospha_data = traits_shift_data[traits_shift_data$trait == "beta_glu",]
hist(phospha_data$CWM,breaks =48 )
hist(phospha_data$delta_ab_shift,breaks =48 )
hist(phospha_data$delta_intra_shift,breaks =48 )
mod_CWM <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = phospha_data)
summary(mod_CWM)
coef_CWM = summary(mod_CWM)$coefficients
hist(summary(mod_CWM)$residuals, breaks = 48)
hist(phospha_data$CWM)
ggplot(phospha_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM[1,1], slope = coef_CWM[2,1],
linetype =2 , color = "blue")
##### models CWM #####
biomass_data = traits_shift_data[traits_shift_data$trait == "biomass",]
hist(biomass_data$CWM,breaks =48 )
hist(biomass_data$delta_ab_shift,breaks =48 )
hist(biomass_data$delta_intra_shift,breaks =48 )
mod_CWM_bioma <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = biomass_data)
summary(mod_CWM_bioma)
coef_CWM_bioma = summary(mod_CWM_bioma)$coefficients
hist(summary(mod_CWM_bioma)$residuals, breaks = 48)
hist(biomass_data$CWM)
ggplot(biomass_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_bioma[1,1], slope = coef_CWM_bioma[2,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_boxplot(aes(as.factor(feasibility), CWM))+
geom_abline(intercept = coef_CWM_bioma[1,1], slope = coef_CWM_bioma[3,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_point(aes(indirect_effects, CWM))+
geom_abline(intercept = coef_CWM_bioma[1,1], slope = coef_CWM_bioma[4,1],
linetype =2 , color = "blue")
ggplot(biomass_data)+
geom_point(aes(year_extinction , CWM))+
geom_abline(intercept = coef_CWM_bioma[1,1], slope = coef_CWM_bioma[5,1],
linetype =2 , color = "blue")+
scale_x_log10()
head(traits_shift_data)
##### models CWM #####
beta_glu_data = traits_shift_data[traits_shift_data$trait == "beta_glu",]
hist(beta_glu_data$CWM,breaks =48 )
hist(beta_glu_data$delta_ab_shift,breaks =48 )
hist(beta_glu_data$delta_intra_shift,breaks =48 )
mod_CWM_betaG <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = beta_glu_data)
summary(mod_CWM_betaG)
coef_CWM_betaG = summary(mod_CWM_betaG)$coefficients
hist(summary(mod_CWM_betaG)$residuals, breaks = 48)
hist(beta_glu_data$CWM)
ggplot(beta_glu_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[2,1],
linetype =2 , color = "blue")
hist(summary(mod_CWM_betaG)$residuals, breaks = 48)
hist(beta_glu_data$CWM)
ggplot(beta_glu_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[2,1],
linetype =2 , color = "blue")
beta_glu_data
biomass_data
CWM
beta_glu_data
ggplot(biomass_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_bioma[1,1], slope = coef_CWM_bioma[2,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[2,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_boxplot(aes(as.factor(feasibility), CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[3,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_point(aes(indirect_effects, CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[4,1],
linetype =2 , color = "blue")
ggplot(beta_glu_data)+
geom_point(aes(year_extinction , CWM))+
geom_abline(intercept = coef_CWM_betaG[1,1], slope = coef_CWM_betaG[5,1],
linetype =2 , color = "blue")+
scale_x_log10()
head(traits_shift_data)
traits_shift_data$trait
##### models CWM #####
phospha_data = traits_shift_data[traits_shift_data$trait == "beta_glu",]
hist(phospha_data$CWM,breaks =48 )
hist(phospha_data$delta_ab_shift,breaks =48 )
hist(phospha_data$delta_intra_shift,breaks =48 )
mod_CWM_phospha <- lm(formula = CWM ~ Omega +
feasibility +
indirect_effects +
log(year_extinction), data = phospha_data)
summary(mod_CWM_phospha)
coef_CWM_phospha = summary(mod_CWM_phospha)$coefficients
hist(summary(mod_CWM_phospha)$residuals, breaks = 48)
hist(phospha_data$CWM)
ggplot(phospha_data)+
geom_point(aes(Omega, CWM))+
geom_abline(intercept = coef_CWM_phospha[1,1], slope = coef_CWM_phospha[2,1],
linetype =2 , color = "blue")
ggplot(phospha_data)+
geom_boxplot(aes(as.factor(feasibility), CWM))+
geom_abline(intercept = coef_CWM_phospha[1,1], slope = coef_CWM_phospha[3,1],
linetype =2 , color = "blue")
ggplot(phospha_data)+
geom_point(aes(indirect_effects, CWM))+
geom_abline(intercept = coef_CWM_phospha[1,1], slope = coef_CWM_phospha[4,1],
linetype =2 , color = "blue")
ggplot(phospha_data)+
geom_point(aes(year_extinction , CWM))+
geom_abline(intercept = coef_CWM_phospha[1,1], slope = coef_CWM_phospha[5,1],
linetype =2 , color = "blue")+
scale_x_log10()
save.image("~/Fac/Cesure2/Plant_species_coexistence/functions_and_coex/workspaces/wks_modeling_traitshift_coex.RData")
